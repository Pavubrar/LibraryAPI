 name: Build docker image, push to ACR and deploy to linux web app

 on:
   push:
     branches:
       - ACA
   workflow_dispatch:

 jobs:
   build:
     runs-on: ubuntu-latest

     steps:
       - name: Checkout code
         uses: actions/checkout@v4

       - name: Set up Docker Buildx
         uses: docker/setup-buildx-action@v2

       - name: Log in to container registry
         uses: docker/login-action@v2
         with:
           registry: LibraryRegistryVP 
           username: LibraryRegistryVP
           password: 8rLrTa9DSiaeZ9/3N79EmLaYoIt7JrlkBBcXDM4RFo+ACRCyExtn


       - name: Build and push container image to registry
         uses: docker/build-push-action@v3
         with:
           context: .
           push: true
           tags: libraryregistryvp.azurecr.io/library-backend:latest
           file: ./Dockerfile
